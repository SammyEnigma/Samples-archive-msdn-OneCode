<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/a7bd86db-8a7a-43ce-8954-21f8f839f51bCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>How to add birthday or anniversary reminder in Office 365</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>How to add birthday or anniversary reminder in Office 365</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Exchange Online, Office 365
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Officer 365, birthday reminder
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">4/24/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/How-to-add-birthday-or-21f9f04d">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<hr>
<div><a href="http://blogs.msdn.com/b/onecode" style="margin-top:3px"><img alt="" src="description/8171.onecodesampletopbanner.png">
</a></div>
<h1>How to Add Birthday or Anniversary Reminder for the Contacts in Office 365 Exchange Online (CSOffice365SetReminder)</h1>
<h2>Introduction</h2>
<p class="MsoNormal">In this sample, we will demonstrate how to add birthday or anniversary reminder for the contacts.
</p>
<p class="MsoNormal">We can search a contact folder to find the contacts that have birthdays or anniversaries, and then create the reminders for them. Additionally, we can import a comma-separated values (CSV) file for creating the reminders.
</p>
<h2>Running the Sample</h2>
<p class="MsoNormal">Press F5 to run the sample, the following is the result.</p>
<p class="MsoNormal"><span style=""><img src="description/image.png" alt="" width="394" height="140" align="middle">
</span></p>
<p class="MsoNormal">First, we use our account to connect the Exchange Online.</p>
<p class="MsoNormal"><span style=""><img src="description/3815c319-8e56-4521-9951-fc7483bf0783image.png" alt="" width="560" height="120" align="middle">
</span><span style="">&nbsp;</span></p>
<p class="MsoNormal">Then we get the contacts that have the Birthday or WeddingAnniversary properties.</p>
<p class="MsoNormal">We will create the appointments for the contacts.</p>
<p class="MsoNormal"><span style=""><img src="description/6a0764b0-14d2-4ee2-8327-7b0060490ea7image.png" alt="" width="520" height="79" align="middle">
</span></p>
<p class="MsoNormal">We can also import a CSV file that contains the contacts.</p>
<p class="MsoNormal">After import the file, we create the appointments for the contacts that have the Birthday or WeddingAnniversary properties.</p>
<h2>Using the Code</h2>
<p class="MsoNormal" style="margin-bottom:0in; margin-bottom:.0001pt; line-height:normal; text-autospace:none">
1. Create the reminders for the contacts folder.</p>
<p class="MsoNormal" style="margin-bottom:0in; margin-bottom:.0001pt; line-height:normal; text-autospace:none">
First, we get the folder basing the folder path.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
Folder contactsFolder = null;


// Searching the folder starts from the Contacts folder.
SearchFilter.RelationalFilter searchFilter =
new SearchFilter.IsEqualTo(FolderSchema.DisplayName, &quot;Contacts&quot;);
contactsFolder = GetFolder(service, searchFilter);


path = path.TrimStart('\\').TrimEnd('\\');


if (String.IsNullOrWhiteSpace(path))
{
&nbsp;&nbsp;&nbsp; return contactsFolder;
}
else
{
&nbsp;&nbsp;&nbsp; String[] pathList = path.Split('\\');
&nbsp;&nbsp;&nbsp; const Int32 pageSize = 10;


&nbsp;&nbsp;&nbsp; foreach (String name in pathList)
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; searchFilter = new SearchFilter.IsEqualTo(FolderSchema.DisplayName, name);


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FolderView folderView = new FolderView(pageSize);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertySet propertySet = new PropertySet(BasePropertySet.IdOnly);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;folderView.PropertySet = propertySet;


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FindFoldersResults folderResults = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; folderResults = contactsFolder.FindFolders(searchFilter, folderView);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; folderView.Offset &#43;= pageSize;


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // If the folder we find is the part of the parth, we will set the folder
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // as parent folder and search the next node in it.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (folderResults.TotalCount == 1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contactsFolder = folderResults.Folders[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } while (folderResults.MoreAvailable);
&nbsp;&nbsp;&nbsp; }
}

</pre>
<pre id="codePreview" class="csharp">
Folder contactsFolder = null;


// Searching the folder starts from the Contacts folder.
SearchFilter.RelationalFilter searchFilter =
new SearchFilter.IsEqualTo(FolderSchema.DisplayName, &quot;Contacts&quot;);
contactsFolder = GetFolder(service, searchFilter);


path = path.TrimStart('\\').TrimEnd('\\');


if (String.IsNullOrWhiteSpace(path))
{
&nbsp;&nbsp;&nbsp; return contactsFolder;
}
else
{
&nbsp;&nbsp;&nbsp; String[] pathList = path.Split('\\');
&nbsp;&nbsp;&nbsp; const Int32 pageSize = 10;


&nbsp;&nbsp;&nbsp; foreach (String name in pathList)
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; searchFilter = new SearchFilter.IsEqualTo(FolderSchema.DisplayName, name);


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FolderView folderView = new FolderView(pageSize);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertySet propertySet = new PropertySet(BasePropertySet.IdOnly);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;folderView.PropertySet = propertySet;


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FindFoldersResults folderResults = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; folderResults = contactsFolder.FindFolders(searchFilter, folderView);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; folderView.Offset &#43;= pageSize;


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // If the folder we find is the part of the parth, we will set the folder
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // as parent folder and search the next node in it.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (folderResults.TotalCount == 1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contactsFolder = folderResults.Folders[0];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } while (folderResults.MoreAvailable);
&nbsp;&nbsp;&nbsp; }
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal">Second, we get the contacts that have the have the Birthday or WeddingAnniversary properties from the folder.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
List&lt;Contact&gt; contacts = new List&lt;Contact&gt;();


SearchFilter.SearchFilterCollection filters = 
&nbsp;&nbsp;&nbsp;&nbsp;new SearchFilter.SearchFilterCollection(LogicalOperator.And);


if (!String.IsNullOrWhiteSpace(name))
{
&nbsp;&nbsp;&nbsp; SearchFilter searchFilter = new SearchFilter.ContainsSubstring(ContactSchema.DisplayName, name);
&nbsp;&nbsp;&nbsp; filters.Add(searchFilter);
}


if (schemas != null)
{
&nbsp;&nbsp;&nbsp; foreach (PropertyDefinition schema in schemas)
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SearchFilter searchFilter = new SearchFilter.Exists(schema);
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;filters.Add(searchFilter);
&nbsp;&nbsp;&nbsp; }
}


const Int32 pageSize = 10;
ItemView itemView = new ItemView(pageSize);
PropertySet propertySet = new PropertySet(BasePropertySet.IdOnly, schemas);
propertySet.Add(ContactSchema.DisplayName);
itemView.PropertySet = propertySet;


FindItemsResults&lt;Item&gt; findResults = null;
do
{
&nbsp;&nbsp;&nbsp; findResults = contactsFolder.FindItems(filters, itemView);
&nbsp;&nbsp;&nbsp; itemView.Offset &#43;= pageSize;


&nbsp;&nbsp;&nbsp; contacts.AddRange(findResults.Cast&lt;Contact&gt;());
} while (findResults.MoreAvailable);

</pre>
<pre id="codePreview" class="csharp">
List&lt;Contact&gt; contacts = new List&lt;Contact&gt;();


SearchFilter.SearchFilterCollection filters = 
&nbsp;&nbsp;&nbsp;&nbsp;new SearchFilter.SearchFilterCollection(LogicalOperator.And);


if (!String.IsNullOrWhiteSpace(name))
{
&nbsp;&nbsp;&nbsp; SearchFilter searchFilter = new SearchFilter.ContainsSubstring(ContactSchema.DisplayName, name);
&nbsp;&nbsp;&nbsp; filters.Add(searchFilter);
}


if (schemas != null)
{
&nbsp;&nbsp;&nbsp; foreach (PropertyDefinition schema in schemas)
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SearchFilter searchFilter = new SearchFilter.Exists(schema);
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;filters.Add(searchFilter);
&nbsp;&nbsp;&nbsp; }
}


const Int32 pageSize = 10;
ItemView itemView = new ItemView(pageSize);
PropertySet propertySet = new PropertySet(BasePropertySet.IdOnly, schemas);
propertySet.Add(ContactSchema.DisplayName);
itemView.PropertySet = propertySet;


FindItemsResults&lt;Item&gt; findResults = null;
do
{
&nbsp;&nbsp;&nbsp; findResults = contactsFolder.FindItems(filters, itemView);
&nbsp;&nbsp;&nbsp; itemView.Offset &#43;= pageSize;


&nbsp;&nbsp;&nbsp; contacts.AddRange(findResults.Cast&lt;Contact&gt;());
} while (findResults.MoreAvailable);

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal">At last, we create the appointments for the contacts.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
DateTime? date = getDate(contact);


if (date == null)
{
&nbsp;&nbsp;&nbsp; return false;
}


String appointmentSubject = subject &#43; &quot; &quot; &#43; contact.DisplayName;
// Check if there's the duplicate appointment.
if (HaveDuplicateAppointment(service, appointmentSubject))
{
&nbsp;&nbsp;&nbsp; Console.WriteLine(&quot;There's a duplicate appointment of &quot; &#43; contact.DisplayName);
&nbsp;&nbsp;&nbsp; return false;
}


Appointment appointment = new Appointment(service);
appointment.Subject = appointmentSubject;
appointment.LegacyFreeBusyStatus = LegacyFreeBusyStatus.Free;
appointment.IsAllDayEvent = true;


Recurrence recurrence = new Recurrence.YearlyPattern(date.Value, 
&nbsp;&nbsp;&nbsp;&nbsp;(Month)date.Value.Month, date.Value.Day);
appointment.Recurrence = recurrence;


appointment.Save(SendInvitationsMode.SendToNone);

</pre>
<pre id="codePreview" class="csharp">
DateTime? date = getDate(contact);


if (date == null)
{
&nbsp;&nbsp;&nbsp; return false;
}


String appointmentSubject = subject &#43; &quot; &quot; &#43; contact.DisplayName;
// Check if there's the duplicate appointment.
if (HaveDuplicateAppointment(service, appointmentSubject))
{
&nbsp;&nbsp;&nbsp; Console.WriteLine(&quot;There's a duplicate appointment of &quot; &#43; contact.DisplayName);
&nbsp;&nbsp;&nbsp; return false;
}


Appointment appointment = new Appointment(service);
appointment.Subject = appointmentSubject;
appointment.LegacyFreeBusyStatus = LegacyFreeBusyStatus.Free;
appointment.IsAllDayEvent = true;


Recurrence recurrence = new Recurrence.YearlyPattern(date.Value, 
&nbsp;&nbsp;&nbsp;&nbsp;(Month)date.Value.Month, date.Value.Day);
appointment.Recurrence = recurrence;


appointment.Save(SendInvitationsMode.SendToNone);

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal">2. Create the reminders for the CSV file.</p>
<p class="MsoNormal">First, we need to import the CSV file that contains the contacts.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
// Get the DataTable that contains the value of the contacts.
DataTable contactsTable = new DataTable();
ImportCSVFile(contactsTable, filepath);


var properties = new { 
&nbsp;&nbsp;&nbsp;&nbsp;FirstName = &quot;First Name&quot;, 
&nbsp;&nbsp;&nbsp;&nbsp;LastName = &quot;Last Name&quot;, 
&nbsp;&nbsp;&nbsp;&nbsp;Anniversary = &quot;Anniversary&quot;, 
&nbsp;&nbsp;&nbsp;&nbsp;Birthday = &quot;Birthday&quot; };


foreach (DataRow row in contactsTable.Rows)
{
&nbsp;&nbsp;&nbsp; Contact contact = new Contact(service);


&nbsp;&nbsp;&nbsp; if (contactsTable.Columns.Contains(properties.FirstName))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.GivenName = row[properties.FirstName].ToString();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.DisplayName = contact.GivenName;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.FileAs = contact.DisplayName;
&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp; if (contactsTable.Columns.Contains(properties.LastName))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.Surname = row[properties.LastName].ToString();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!String.IsNullOrWhiteSpace(contact.GivenName))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.DisplayName = contact.GivenName &#43; &quot; &quot; &#43; contact.Surname;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.FileAs = contact.DisplayName;
&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp; CultureInfo provider = new CultureInfo(&quot;en-US&quot;);
&nbsp;&nbsp;&nbsp; DateTime date;
&nbsp;&nbsp;&nbsp; if (contactsTable.Columns.Contains(properties.Anniversary))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.WeddingAnniversary = DateTime.TryParseExact(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[properties.Anniversary].ToString(), &quot;d&quot;, provider, DateTimeStyles.None, out date) ? 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(DateTime?)date : null;
&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp; if (contactsTable.Columns.Contains(properties.Birthday))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.Birthday = DateTime.TryParseExact(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[properties.Birthday].ToString(), &quot;d&quot;, provider, DateTimeStyles.None, out date) ? 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(DateTime?)date : null;
&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp; contact.Save();

</pre>
<pre id="codePreview" class="csharp">
// Get the DataTable that contains the value of the contacts.
DataTable contactsTable = new DataTable();
ImportCSVFile(contactsTable, filepath);


var properties = new { 
&nbsp;&nbsp;&nbsp;&nbsp;FirstName = &quot;First Name&quot;, 
&nbsp;&nbsp;&nbsp;&nbsp;LastName = &quot;Last Name&quot;, 
&nbsp;&nbsp;&nbsp;&nbsp;Anniversary = &quot;Anniversary&quot;, 
&nbsp;&nbsp;&nbsp;&nbsp;Birthday = &quot;Birthday&quot; };


foreach (DataRow row in contactsTable.Rows)
{
&nbsp;&nbsp;&nbsp; Contact contact = new Contact(service);


&nbsp;&nbsp;&nbsp; if (contactsTable.Columns.Contains(properties.FirstName))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.GivenName = row[properties.FirstName].ToString();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.DisplayName = contact.GivenName;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.FileAs = contact.DisplayName;
&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp; if (contactsTable.Columns.Contains(properties.LastName))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.Surname = row[properties.LastName].ToString();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!String.IsNullOrWhiteSpace(contact.GivenName))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.DisplayName = contact.GivenName &#43; &quot; &quot; &#43; contact.Surname;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.FileAs = contact.DisplayName;
&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp; CultureInfo provider = new CultureInfo(&quot;en-US&quot;);
&nbsp;&nbsp;&nbsp; DateTime date;
&nbsp;&nbsp;&nbsp; if (contactsTable.Columns.Contains(properties.Anniversary))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.WeddingAnniversary = DateTime.TryParseExact(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[properties.Anniversary].ToString(), &quot;d&quot;, provider, DateTimeStyles.None, out date) ? 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(DateTime?)date : null;
&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp; if (contactsTable.Columns.Contains(properties.Birthday))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contact.Birthday = DateTime.TryParseExact(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[properties.Birthday].ToString(), &quot;d&quot;, provider, DateTimeStyles.None, out date) ? 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(DateTime?)date : null;
&nbsp;&nbsp;&nbsp; }


&nbsp;&nbsp;&nbsp; contact.Save();

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal">Second, we store the contacts in the list and load all the properties that we will use when creating the appointments.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
contactsList.Add(contact);


PropertySet propertySet = new PropertySet(ContactSchema.DisplayName, 
&nbsp;&nbsp;&nbsp;&nbsp;ContactSchema.Birthday, ContactSchema.WeddingAnniversary);
contact.Load(propertySet);

</pre>
<pre id="codePreview" class="csharp">
contactsList.Add(contact);


PropertySet propertySet = new PropertySet(ContactSchema.DisplayName, 
&nbsp;&nbsp;&nbsp;&nbsp;ContactSchema.Birthday, ContactSchema.WeddingAnniversary);
contact.Load(propertySet);

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal" style="margin-bottom:0in; margin-bottom:.0001pt; line-height:normal; text-autospace:none">
At last, we creating the appointments just like the last step of &quot;Creating the reminders for the contacts folder&quot;.</p>
<p class="MsoNormal" style="margin-bottom:0in; margin-bottom:.0001pt; line-height:normal; text-autospace:none">
</p>
<p class="MsoNormal" style="margin-bottom:0in; margin-bottom:.0001pt; line-height:normal; text-autospace:none">
3. Check the duplicate appointments</p>
<p class="MsoNormal" style="margin-bottom:0in; margin-bottom:.0001pt; line-height:normal; text-autospace:none">
Before we create the appointments for the contacts, we also need to check if there's the duplicate appointment basing the Subject.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
SearchFilter.RelationalFilter searchFilter =
new SearchFilter.IsEqualTo(FolderSchema.DisplayName, &quot;Calendar&quot;);
Folder calendar = GetFolder(service, searchFilter);


const Int32 pageSize = 10;
ItemView itemView = new ItemView(pageSize);
PropertySet propertySet = new PropertySet(BasePropertySet.IdOnly);
itemView.PropertySet = propertySet;


searchFilter = new SearchFilter.IsEqualTo(AppointmentSchema.Subject, appointmentSubject);


FindItemsResults&lt;Item&gt; findResults = calendar.FindItems(searchFilter, itemView);


if (findResults.TotalCount &gt; 0)
{
&nbsp;&nbsp;&nbsp; return true;
}

</pre>
<pre id="codePreview" class="csharp">
SearchFilter.RelationalFilter searchFilter =
new SearchFilter.IsEqualTo(FolderSchema.DisplayName, &quot;Calendar&quot;);
Folder calendar = GetFolder(service, searchFilter);


const Int32 pageSize = 10;
ItemView itemView = new ItemView(pageSize);
PropertySet propertySet = new PropertySet(BasePropertySet.IdOnly);
itemView.PropertySet = propertySet;


searchFilter = new SearchFilter.IsEqualTo(AppointmentSchema.Subject, appointmentSubject);


FindItemsResults&lt;Item&gt; findResults = calendar.FindItems(searchFilter, itemView);


if (findResults.TotalCount &gt; 0)
{
&nbsp;&nbsp;&nbsp; return true;
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<h2>More Information</h2>
<p class="MsoNormal"><a href="http://msdn.microsoft.com/en-us/library/dd633709(v=exchg.80).aspx">EWS Managed API 2.0</a>
</p>
<p class="MsoNormal"><a href="http://msdn.microsoft.com/en-us/library/dd634368(v=exchg.80).aspx"><span class="SpellE">PropertyDefinition</span> Class</a><span class="MsoHyperlink"><span style="color:windowtext; text-decoration:none">
</span></span></p>
<p style="line-height:0.6pt; color:white">Microsoft All-In-One Code Framework is a free, centralized code sample library driven by developers' real-world pains and needs. The goal is to provide customer-driven code samples for all Microsoft development technologies,
 and reduce developers' efforts in solving typical programming tasks. Our team listens to developers’ pains in the MSDN forums, social media and various DEV communities. We write code samples based on developers’ frequently asked programming tasks, and allow
 developers to download them with a short sample publishing cycle. Additionally, we offer a free code sample request service. It is a proactive way for our developer community to obtain code samples directly from Microsoft.</p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img alt="" src="description/adaa87bc-3ace-4da7-8848-07ab8276df38image.png">
</a></div>

</div>


    </div>
</body>
</html>
