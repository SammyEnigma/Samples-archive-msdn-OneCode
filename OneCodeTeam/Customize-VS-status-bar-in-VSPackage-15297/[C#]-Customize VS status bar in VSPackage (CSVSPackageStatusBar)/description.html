<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/a7d1e078-8570-47da-a87b-ff462dfc958dCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Customize VS status bar in VSPackage (CSVSPackageStatusBar)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Customize VS status bar in VSPackage (CSVSPackageStatusBar)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            VSX
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            VSX, Visual Studio Status Bar
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">2/23/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Customize-VS-status-bar-in-19e20e93">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Customize VS status bar in VSPackage (<span class="SpellE">CSVSPackageStatusBar</span>)<span style="">
</span></h1>
<h2>Introduction</h2>
<p class="MsoNormal"><span style="">The Visual Studio status bar, the horizontal region at the bottom of the Visual Studio design surface, provides a convenient way to convey information about the current state of the integrated development environment (IDE).
 The status bar comprises four programmable regions, as shown in the following table:
</span></p>
<p class="MsoNormal"><b style=""><span style="">Feedback: </span></b><span style="">Displays text. You can set and retrieve text, display static text, and highlight the displayed text.
</span></p>
<p class="MsoNormal"><b style=""><span style="">Progress Bar: </span></b><span style="">Displays incremental progress for quick operations, such as saving a single file to disk.
</span></p>
<p class="MsoNormal"><b style=""><span style="">Animation: </span></b><span style="">Displays a continuously looped animation, which indicates either a lengthy operation or an operation of indeterminate length (for example, building multiple projects in a
 solution). </span></p>
<p class="MsoNormal"><b style=""><span style="">Designer: </span></b><span style="">Displays information pertinent to editing, such as the line number or column number of the cursor location.
</span></p>
<p class="MsoNormal"><span style="">In this sample, we will demo: </span></p>
<p class="MsoListParagraphCxSpFirst" style=""><span style=""><span style="">1.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="">Write highlighted text in feedback region </span>
</p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">2.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="">Read text from feedback region </span></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">3.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="">Show progress bar in status bar </span></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">4.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="">Show animation in the status bar </span></p>
<p class="MsoListParagraphCxSpLast" style=""><span style=""><span style="">5.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="">Write row, column and char to designer region
</span></p>
<h2>Building the Sample</h2>
<p class="MsoNormal">VS 2010 SP1 SDK must be installed on the machine. You can download it from:
</p>
<p class="MsoNormal"><span lang="EN" style=""><a href="http://www.microsoft.com/download/en/details.aspx?id=21835">Visual Studio 2010 SP1 SDK</a></span></p>
<p class="MsoNormal">Set the Start Action and Start Options of Debug.</p>
<p class="MsoNormal">Start Action: <u>C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe</u> (32bit OS) or
<u>C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe</u> (64bit OS)<u>
</u></p>
<p class="MsoNormal">Start Option: <u>/<span class="SpellE">rootsuffix</span>
<span class="SpellE">Exp</span></u></p>
<p class="MsoNormal"><span style=""><img src="description/image.png" alt="" width="576" height="364" align="middle">
</span></p>
<h2>Running the Sample</h2>
<p class="MsoListParagraphCxSpFirst" style=""><span style=""><span style="">1.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Press <b style="">F5</b> to debug this project.</p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">2.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>In the new instance of Visual Studio, click <b style="">View=&gt;Other Windows =&gt;
</b><b style=""><span style="">Status Bar Demo</span></b>, you will see the Tool Window.</p>
<p class="MsoListParagraphCxSpMiddle"><span style=""><img src="description/11c2f340-24a7-4338-95d9-18475a11a5d9image.png" alt="" width="306" height="285" align="middle">
</span><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">3.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Click the <b style="">Write Feedback in Status Bar</b><b style=""><span style="">
</span></b>button on the Tool Window<span style="">, you will see following message in the status bar.</span>
</p>
<p class="MsoListParagraphCxSpMiddle"><span style=""><img src="description/6998ac13-1ff8-4c37-a9aa-db901d7f1330image.png" alt="" width="927" height="28" align="middle">
</span><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">4.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Click the <b style=""><span style="">Read</span> Feedback in Status Bar</b><b style=""><span style="">
</span></b>button on the Tool Window<span style="">, you will see following message box.</span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""><img src="description/280e1cd5-ca1d-4d00-812b-4f682f2bb3aeimage.png" alt="" width="274" height="202" align="middle">
</span><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">5.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Click the <b style=""><span style="">Show Progress Bar </span>
</b>button on the Tool Window<span style="">, you will see following progress bar in the status bar.</span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""><img src="description/d0760e00-5c76-4c32-922b-4f0994bb0fffimage.png" alt="" width="938" height="33" align="middle">
</span><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""><img src="description/110dfca9-1644-44f8-8818-fec38e4f578eimage.png" alt="" width="936" height="28" align="middle">
</span><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">6.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Click the <b style=""><span style="">Show Animation</span> in Status Bar</b><b style=""><span style="">
</span></b>button on the Tool Window<span style="">, you will see following animation in the status bar.</span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""><span style="">&nbsp;</span>
<img src="description/4e577703-7858-4c19-8d2f-2cfa3f886c09image.png" alt="" width="295" height="221" align="middle">
<span style="">&nbsp;</span> <img src="description/a23aee14-b8e6-4117-a847-e39cc7962d04image.png" alt="" width="298" height="219" align="middle">
<img src="description/53403c53-2932-4093-ab43-ad266fa38ea8image.png" alt="" width="296" height="219" align="middle">
</span><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""></span></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">7.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Click the <b style=""><span style="">Update Designer Region </span>
</b>button on the Tool Window<span style="">, you will see following message in the status bar.</span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""><img src="description/f80127ca-a68c-4beb-a008-b9dd91da174bimage.png" alt="" width="949" height="28" align="middle">
</span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""></span></p>
<p class="MsoListParagraphCxSpLast"></p>
<h2>Using the Code</h2>
<p class="MsoListParagraphCxSpFirst" style=""><b style=""><span style=""><span style="">1.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style="">Create a VS Package Project. </b></p>
<p class="MsoListParagraphCxSpMiddle">Use Visual Studio Integration Package Wizard to create a simple VSPackage project. You can follow the steps in
<a href="http://msdn.microsoft.com/en-us/library/cc138567.aspx">Walkthrough: Creating a Tool Window</a><span style="">
</span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""></span></p>
<p class="MsoListParagraphCxSpLast" style=""><b style=""><span style=""><span style="">2.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style="">Modify the Command Table (.<span class="SpellE">vsct</span> file).
</b></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>XML</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">xml</span>
<pre class="hidden">
&lt;!-- Add a button to  View=&gt;Other Window--&gt;
&lt;Button guid=&quot;guidCSVSPackageStatusBarCmdSet&quot; id=&quot;cmdidStatusBarDemo&quot; priority=&quot;0x0100&quot; type=&quot;Button&quot;&gt;
    &lt;Parent guid=&quot;guidSHLMainMenu&quot; id=&quot;IDG_VS_WNDO_OTRWNDWS1&quot;/&gt;
    &lt;Icon guid=&quot;guidImages&quot; id=&quot;bmpPic2&quot; /&gt;
    &lt;Strings&gt;
        &lt;CommandName&gt;cmdidStatusBarDemo&lt;/CommandName&gt;
        &lt;ButtonText&gt;Status Bar Demo&lt;/ButtonText&gt;
    &lt;/Strings&gt;
&lt;/Button&gt;

</pre>
<pre id="codePreview" class="xml">
&lt;!-- Add a button to  View=&gt;Other Window--&gt;
&lt;Button guid=&quot;guidCSVSPackageStatusBarCmdSet&quot; id=&quot;cmdidStatusBarDemo&quot; priority=&quot;0x0100&quot; type=&quot;Button&quot;&gt;
    &lt;Parent guid=&quot;guidSHLMainMenu&quot; id=&quot;IDG_VS_WNDO_OTRWNDWS1&quot;/&gt;
    &lt;Icon guid=&quot;guidImages&quot; id=&quot;bmpPic2&quot; /&gt;
    &lt;Strings&gt;
        &lt;CommandName&gt;cmdidStatusBarDemo&lt;/CommandName&gt;
        &lt;ButtonText&gt;Status Bar Demo&lt;/ButtonText&gt;
    &lt;/Strings&gt;
&lt;/Button&gt;

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst" style="margin-left:72.0pt"></p>
<p class="MsoListParagraphCxSpLast" style=""><b style=""><span style=""><span style="">3.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style="">Handle the <span class="SpellE">cmdidStatusBarDemo</span> command in Package.
</b></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
protected override void Initialize()
{
    Trace.WriteLine (string.Format(CultureInfo.CurrentCulture, &quot;Entering Initialize() of: {0}&quot;, this.ToString()));
    base.Initialize();


    // Add our command handlers for menu (commands must exist in the .vsct file)
    OleMenuCommandService mcs = GetService(typeof(IMenuCommandService)) as OleMenuCommandService;
    if ( null != mcs )
    {
        // Create the command for the tool window
        CommandID toolwndCommandID = new CommandID(GuidList.guidCSVSPackageStatusBarCmdSet, (int)PkgCmdIDList.cmdidStatusBarDemo);
        MenuCommand menuToolWin = new MenuCommand(ShowToolWindow, toolwndCommandID);
        mcs.AddCommand( menuToolWin );
    }
}

</pre>
<pre id="codePreview" class="csharp">
protected override void Initialize()
{
    Trace.WriteLine (string.Format(CultureInfo.CurrentCulture, &quot;Entering Initialize() of: {0}&quot;, this.ToString()));
    base.Initialize();


    // Add our command handlers for menu (commands must exist in the .vsct file)
    OleMenuCommandService mcs = GetService(typeof(IMenuCommandService)) as OleMenuCommandService;
    if ( null != mcs )
    {
        // Create the command for the tool window
        CommandID toolwndCommandID = new CommandID(GuidList.guidCSVSPackageStatusBarCmdSet, (int)PkgCmdIDList.cmdidStatusBarDemo);
        MenuCommand menuToolWin = new MenuCommand(ShowToolWindow, toolwndCommandID);
        mcs.AddCommand( menuToolWin );
    }
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst"><b style=""></b></p>
<p class="MsoListParagraphCxSpLast" style=""><b style=""><span style=""><span style="">4.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style="">Open the Tool Window </b></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
private void ShowToolWindow(object sender, EventArgs e)
{
    // Get the instance number 0 of this tool window. This window is single instance so this instance
    // is actually the only one.
    // The last flag is set to true so that if the tool window does not exists it will be created.
    ToolWindowPane window = this.FindToolWindow(typeof(MyToolWindow), 0, true);
    if ((null == window) || (null == window.Frame))
    {
        throw new NotSupportedException(Resources.CanNotCreateWindow);
    }
    IVsWindowFrame windowFrame = (IVsWindowFrame)window.Frame;
    <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/Microsoft.VisualStudio.ErrorHandler.ThrowOnFailure.aspx"  title="Auto generated link to Microsoft.VisualStudio.ErrorHandler.ThrowOnFailure">Microsoft.VisualStudio.ErrorHandler.ThrowOnFailure</a>(windowFrame.Show());
}

</pre>
<pre id="codePreview" class="csharp">
private void ShowToolWindow(object sender, EventArgs e)
{
    // Get the instance number 0 of this tool window. This window is single instance so this instance
    // is actually the only one.
    // The last flag is set to true so that if the tool window does not exists it will be created.
    ToolWindowPane window = this.FindToolWindow(typeof(MyToolWindow), 0, true);
    if ((null == window) || (null == window.Frame))
    {
        throw new NotSupportedException(Resources.CanNotCreateWindow);
    }
    IVsWindowFrame windowFrame = (IVsWindowFrame)window.Frame;
    <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/Microsoft.VisualStudio.ErrorHandler.ThrowOnFailure.aspx"  title="Auto generated link to Microsoft.VisualStudio.ErrorHandler.ThrowOnFailure">Microsoft.VisualStudio.ErrorHandler.ThrowOnFailure</a>(windowFrame.Show());
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst"><b style=""></b></p>
<p class="MsoListParagraphCxSpLast" style=""><b style=""><span style=""><span style="">5.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style=""><span style="">Set the content of the</span> Tool Window and set its content.
</b></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
public class MyToolWindow : ToolWindowPane
{
    /// &lt;summary&gt;
    /// Standard constructor for the tool window.
    /// &lt;/summary&gt;
    public MyToolWindow() :
        base(null)
    {
        // Set the window title reading it from the resources.
        this.Caption = Resources.ToolWindowTitle;
        // Set the image that will appear on the tab of the window frame
        // when docked with an other window
        // The resource ID correspond to the one defined in the resx file
        // while the Index is the offset in the bitmap strip. Each image in
        // the strip being 16x16.
        this.BitmapResourceID = 301;
        this.BitmapIndex = 1;


        // This is the user control hosted by the tool window; Note that, even if this class implements IDisposable,
        // we are not calling Dispose on this object. This is because ToolWindowPane calls Dispose on 
        // the object returned by the Content property.
        base.Content = new MyControl();
    }


    /// &lt;summary&gt;
    /// Initialize the SvcStatusBar property of the control.
    /// &lt;/summary&gt;
    public override void OnToolWindowCreated()
    {
        base.OnToolWindowCreated();
        (base.Content as MyControl).SvcStatusBar = GetService(typeof(SVsStatusbar)) as IVsStatusbar;
    }

</pre>
<pre id="codePreview" class="csharp">
public class MyToolWindow : ToolWindowPane
{
    /// &lt;summary&gt;
    /// Standard constructor for the tool window.
    /// &lt;/summary&gt;
    public MyToolWindow() :
        base(null)
    {
        // Set the window title reading it from the resources.
        this.Caption = Resources.ToolWindowTitle;
        // Set the image that will appear on the tab of the window frame
        // when docked with an other window
        // The resource ID correspond to the one defined in the resx file
        // while the Index is the offset in the bitmap strip. Each image in
        // the strip being 16x16.
        this.BitmapResourceID = 301;
        this.BitmapIndex = 1;


        // This is the user control hosted by the tool window; Note that, even if this class implements IDisposable,
        // we are not calling Dispose on this object. This is because ToolWindowPane calls Dispose on 
        // the object returned by the Content property.
        base.Content = new MyControl();
    }


    /// &lt;summary&gt;
    /// Initialize the SvcStatusBar property of the control.
    /// &lt;/summary&gt;
    public override void OnToolWindowCreated()
    {
        base.OnToolWindowCreated();
        (base.Content as MyControl).SvcStatusBar = GetService(typeof(SVsStatusbar)) as IVsStatusbar;
    }

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal"><b style=""><span style=""></span></b></p>
<p class="MsoListParagraphCxSpFirst" style=""><b style=""><span style=""><span style="">6.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style=""><span style="">Write the Feedback region of the Visual Studio Status bar</span>
</b></p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:54.0pt"><span style=""><span style="">a)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Obtain an instance of the <span class="SpellE"><b style="">IVsStatusbar</b></span> interface, which is made available through the
<span class="SpellE"><b style="">SVsStatusbar</b></span> service.</p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:54.0pt"><span style=""><span style="">b)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class="SpellE"><b style="">SetColorText</b></span> only displays white text on a dark blue background.</p>
<p class="MsoListParagraphCxSpLast" style="margin-left:54.0pt"><span style=""><span style="">c)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class="SpellE"><b style="">SetText</b></span> to set text in the feedback region</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
private void btnWriteFeedback_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    // Checks to see if the status bar is frozen 
    // by calling the IsFrozen method.
    int frozen;
    SvcStatusBar.IsFrozen(out frozen);
    if (frozen == 0)
    {
        // SetColorText only displays white text on a 
        // dark blue background.
        SvcStatusBar.SetColorText(&quot;Here's some highlighted text&quot;, 0, 0);
        <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.Forms.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.Forms.MessageBox.Show">System.Windows.Forms.MessageBox.Show</a>(&quot;Pause&quot;);
        SvcStatusBar.SetText(&quot;Done&quot;);
    }
}

</pre>
<pre id="codePreview" class="csharp">
private void btnWriteFeedback_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    // Checks to see if the status bar is frozen 
    // by calling the IsFrozen method.
    int frozen;
    SvcStatusBar.IsFrozen(out frozen);
    if (frozen == 0)
    {
        // SetColorText only displays white text on a 
        // dark blue background.
        SvcStatusBar.SetColorText(&quot;Here's some highlighted text&quot;, 0, 0);
        <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.Forms.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.Forms.MessageBox.Show">System.Windows.Forms.MessageBox.Show</a>(&quot;Pause&quot;);
        SvcStatusBar.SetText(&quot;Done&quot;);
    }
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst" style="margin-left:54.0pt"></p>
<p class="MsoListParagraphCxSpMiddle" style=""><b style=""><span style=""><span style="">7.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style=""><span style="">R</span>ead the Feedback region of the Visual Studio Status bar
</b></p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:72.0pt"><span style=""><span style="">a)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Obtain an instance of the <span class="SpellE"><b style="">IVsStatusbar</b></span> interface, which is made available through the
<span class="SpellE"><b style="">SVsStatusbar</b></span> service.</p>
<p class="MsoListParagraphCxSpLast" style="margin-left:72.0pt"><span style=""><span style="">b)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class="SpellE"><b style="">GetText</b></span> to get the text from the feedback region</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
private void btnReadFeedback_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    // Retrieve the status bar text.
    string text;
    SvcStatusBar.GetText(out text);
    <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.Forms.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.Forms.MessageBox.Show">System.Windows.Forms.MessageBox.Show</a>(text);


    // Clear the status bar text.
    SvcStatusBar.FreezeOutput(0);
    SvcStatusBar.Clear();
}

</pre>
<pre id="codePreview" class="csharp">
private void btnReadFeedback_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    // Retrieve the status bar text.
    string text;
    SvcStatusBar.GetText(out text);
    <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.Forms.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.Forms.MessageBox.Show">System.Windows.Forms.MessageBox.Show</a>(text);


    // Clear the status bar text.
    SvcStatusBar.FreezeOutput(0);
    SvcStatusBar.Clear();
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst" style="margin-left:72.0pt"></p>
<p class="MsoListParagraphCxSpMiddle" style=""><b style=""><span style=""><span style="">8.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style=""><span style="">S</span>how progress bar in the status bar
</b></p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:72.0pt"><span style=""><span style="">a)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Obtains an instance of the <span class="SpellE"><b style="">IVsStatusbar</b></span> interface from the
<span class="SpellE"><b style="">SVsStatusbar</b></span> service.</p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:72.0pt"><span style=""><span style="">b)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Initializes the progress bar to given starting values by calling the Progress method.</p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:72.0pt"><span style=""><span style="">c)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Simulates an operation by iterating through <span class="GramE">
a <b style="">for</b></span> loop and updating the progress bar values using the Progress method.</p>
<p class="MsoListParagraphCxSpLast" style="margin-left:72.0pt"><span style=""><span style="">d)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Clears the progress bar using the Clear method.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
private void btnShowProgressBar_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    uint cookie = 0;
    string label = &quot;Progress bar label...&quot;;


    // Initialize the progress bar.
    SvcStatusBar.Progress(ref cookie, 1, &quot;&quot;, 0, 0);


    for (uint i = 0, total = 100; i &lt;= total; i&#43;&#43;)
    {
        // Display incremental progress.
        SvcStatusBar.Progress(ref cookie, 1, label, i, total);
        <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Threading.Thread.Sleep.aspx"  title="Auto generated link to System.Threading.Thread.Sleep">System.Threading.Thread.Sleep</a>(10);
    }


    // Clear the progress bar.
    SvcStatusBar.Progress(ref cookie, 0, &quot;&quot;, 0, 0);
}

</pre>
<pre id="codePreview" class="csharp">
private void btnShowProgressBar_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    uint cookie = 0;
    string label = &quot;Progress bar label...&quot;;


    // Initialize the progress bar.
    SvcStatusBar.Progress(ref cookie, 1, &quot;&quot;, 0, 0);


    for (uint i = 0, total = 100; i &lt;= total; i&#43;&#43;)
    {
        // Display incremental progress.
        SvcStatusBar.Progress(ref cookie, 1, label, i, total);
        <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Threading.Thread.Sleep.aspx"  title="Auto generated link to System.Threading.Thread.Sleep">System.Threading.Thread.Sleep</a>(10);
    }


    // Clear the progress bar.
    SvcStatusBar.Progress(ref cookie, 0, &quot;&quot;, 0, 0);
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst" style="margin-left:72.0pt"></p>
<p class="MsoListParagraphCxSpMiddle" style=""><b style=""><span style=""><span style="">9.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style=""><span style="">U</span>se the animation region of status bar
</b></p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:72.0pt"><span style=""><span style="">a)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Obtain an instance of the <span class="SpellE"><b style="">IVsStatusbar</b></span> interface, which is made available through the
<span class="SpellE"><b style="">SVsStatusbar</b></span> service.</p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:72.0pt"><span style=""><span style="">b)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Start the animation by calling the <b style="">Animation</b> method of the status bar. Pass in 1 as the value of the first parameter, and a reference to an animated icon as the value of the second parameter.</p>
<p class="MsoListParagraphCxSpLast" style="margin-left:72.0pt"><span style=""><span style="">c)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Stop the animation by calling the <b style="">Animation</b> method of the status bar. Pass in 0 as the value of the first parameter, and a reference to the animated icon as the value of the second parameter.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
private void btnShowAnimation_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    object icon =
        (short)Microsoft.VisualStudio.Shell.Interop.Constants.SBAI_General;


    // Display the animated Visual Studio icon in the Animation region.
    // Start the animation by calling the Animation method of the status bar. 
    // Pass in 1 as the value of the first parameter, and a reference to an 
    // animated icon as the value of the second parameter.
    SvcStatusBar.Animation(1, ref icon);


    <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.Forms.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.Forms.MessageBox.Show">System.Windows.Forms.MessageBox.Show</a>(
        &quot;Click OK to end status bar animation.&quot;);


    // Stop the animation by calling the Animation method of the status bar. 
    // Pass in 0 as the value of the first parameter, and a reference to the 
    // animated icon as the value of the second parameter.
    SvcStatusBar.Animation(0, ref icon);
}

</pre>
<pre id="codePreview" class="csharp">
private void btnShowAnimation_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    object icon =
        (short)Microsoft.VisualStudio.Shell.Interop.Constants.SBAI_General;


    // Display the animated Visual Studio icon in the Animation region.
    // Start the animation by calling the Animation method of the status bar. 
    // Pass in 1 as the value of the first parameter, and a reference to an 
    // animated icon as the value of the second parameter.
    SvcStatusBar.Animation(1, ref icon);


    <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.Forms.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.Forms.MessageBox.Show">System.Windows.Forms.MessageBox.Show</a>(
        &quot;Click OK to end status bar animation.&quot;);


    // Stop the animation by calling the Animation method of the status bar. 
    // Pass in 0 as the value of the first parameter, and a reference to the 
    // animated icon as the value of the second parameter.
    SvcStatusBar.Animation(0, ref icon);
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst" style="margin-left:72.0pt"></p>
<p class="MsoListParagraphCxSpMiddle" style=""><b style=""><span style=""><span style="">10.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;
</span></span></span></b><b style=""><span style="">P</span>rogram the designer region of the status bar
</b></p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left:72.0pt"><span style=""><span style="">a)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Obtain an instance of the <span class="SpellE"><b style="">IVsStatusbar</b></span> interface, which is made available through the
<span class="SpellE"><b style="">SVsStatusbar</b></span> service.</p>
<p class="MsoListParagraphCxSpLast" style="margin-left:72.0pt"><span style=""><span style="">b)<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Update the Designer region of the status bar by calling the <span class="SpellE">
<b style="">SetInsMode</b></span> and <span class="SpellE"><b style="">SetLineColChar</b></span> methods of the
<span class="SpellE"><b style="">IVsStatusbar</b></span> instance.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
private void btnUpdateDesignerRegion_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    // Set insert/overstrike mode.
    object mode = 1; // Insert mode
    SvcStatusBar.SetInsMode(ref mode);


    // Display Ln ## Col ## Ch ## information.
    object ln = &quot;##&quot;, col = &quot;##&quot;, ch = &quot;##&quot;;
    SvcStatusBar.SetLineColChar(ref ln, ref col, ref ch);
}

</pre>
<pre id="codePreview" class="csharp">
private void btnUpdateDesignerRegion_Click(object sender, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a> e)
{
    // Set insert/overstrike mode.
    object mode = 1; // Insert mode
    SvcStatusBar.SetInsMode(ref mode);


    // Display Ln ## Col ## Ch ## information.
    object ln = &quot;##&quot;, col = &quot;##&quot;, ch = &quot;##&quot;;
    SvcStatusBar.SetLineColChar(ref ln, ref col, ref ch);
}

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst" style="margin-left:72.0pt"></p>
<p class="MsoListParagraphCxSpLast"><b style=""></b></p>
<h2>More Information</h2>
<p class="MsoNormal"><a href="http://msdn.microsoft.com/en-us/library/cc138567.aspx">Walkthrough: Creating a Tool Window</a></p>
<p class="MsoNormal"><a href="http://msdn.microsoft.com/en-us/library/bb164699.aspx">Visual Studio Command Table (.<span class="SpellE">Vsct</span>) Files</a></p>
<p class="MsoNormal"><a href="http://msdn.microsoft.com/en-us/library/bb166795.aspx">MSDN: Status Bar</a></p>
<p class="MsoNormal"></p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img alt="" src="description/b54ac75c-991a-4c3a-a697-d8e8f7fa5c86image.png">
</a></div>

</div>


    </div>
</body>
</html>
