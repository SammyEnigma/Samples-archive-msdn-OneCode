<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/67b74b86-a273-4ad7-9ed5-0f97276412eaCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Use PowerShell &amp; other techs to manage NAV Services (CSDynamicsPowerShellAdmin)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Use PowerShell &amp; other techs to manage NAV Services (CSDynamicsPowerShellAdmin)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Dynamics
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Powershell, NAV, Dynamics NAV Web Services
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">11/1/2011</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/CSDynamicsPowerShellAdmin-3b682d97">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Microsoft Dynamics NAV APPLICATION: CSDynamicsPowerShellAdmin</h1>
<h2>Introduction</h2>
<p>This sample uses PowerShell to list and manage NAV Services:<br>
&nbsp; - List NAV Services<br>
&nbsp; - Start and stop services<br>
&nbsp; - Enter the name of a remote computer to manager NAV Services on that computer</p>
<p>The sample also uses xml to show and update CustomSettings.config.</p>
<p>The purpose of this sample is to illustrate how to use PowerShell and other technologies for managing NAV Services. It is on purpose developed to be just about useful as it is, but with lots of scope for further development.</p>
<p><br>
The definition of a NAV Service for this purpose is a service where the name of the executable contains &quot;Dynamics.Nav&quot;, and it is assumed that any such service is a Dynamics NAV2009 middle-tier Service for connections from either RoleTailored Client or NAV
 Web Services.</p>
<h2><span style="font-size:medium">Demo</span></h2>
<p>The solution in this sample consists of a form with the following functionality:</p>
<p><strong>Step1.</strong> Click &quot;Get NAV Services&quot; to list the NAV Services running on the local machine.</p>
<p><strong>Step2.</strong> Enter a ComputerName in &quot;NAV Server Name&quot; and then click the same button to list&nbsp;NAV Services on a remote computer.</p>
<p><strong>Step3.</strong> Select a NAV Service from the list, then click Start/Stop to start or stop that&nbsp;service. Note: This part of the sample requires that you first build the project,&nbsp;then run it as Administrator.</p>
<p><strong>Step4.</strong> Select a NAV Service from the list, then click &quot;Get Config&quot; to get selected values&nbsp;from CustomSettings.config belonging to that NAV Service.</p>
<p><strong>Step5.</strong> After &quot;Get Config&quot;, overwrite any of the values, then click &quot;Update Config&quot; to&nbsp;save those to CustomSettings.config.</p>
<p>&nbsp;</p>
<p><span style="font-size:medium; font-weight:bold">Implementation</span></p>
<p>Functionalities demonstrated in this sample:</p>
<p>Step1. List NAV Services, either on local machine or on a remote machine.</p>
<p>Step2. Start and stop any of the services listed.</p>
<p>Step3. View and update values from CustomSettings.config for the selected NAV Service.</p>
<p><span style="font-size:small; font-weight:bold">&nbsp;</span></p>
<p><span style="font-size:medium; font-weight:bold">References</span></p>
<p>Further information and samples for coding with NAV and PowerShell:</p>
<p>C# app invokes PowerShell script (CSPowerShell)<br>
<a href="http://code.msdn.microsoft.com/CSPowerShell-1f44f80dNAV">http://code.msdn.microsoft.com/CSPowerShell-1f44f80d</a><a href="http://code.msdn.microsoft.com/CSPowerShell-1f44f80dNAV"></a></p>
<p>Team Blog<br>
<a href="http://blogs.msdn.com/b/nav">http://blogs.msdn.com/b/nav</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img src="description/95e3bc78-76ea-4f7c-8b0e-445ca740f249image.png" alt=""></a></div>
<p>&nbsp;</p>
<p>&nbsp;</p>

</div>


    </div>
</body>
</html>
