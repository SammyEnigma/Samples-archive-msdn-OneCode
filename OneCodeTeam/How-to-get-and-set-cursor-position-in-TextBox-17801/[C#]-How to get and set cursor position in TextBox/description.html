<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/0aac1760-b513-488a-ba57-e31d9413a075Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>How to get and set cursor position in TextBox</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>How to get and set cursor position in TextBox</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            ASP.NET
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Cursor
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">7/5/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/JSASPNETDiposeTextboxCursor-be6264fa">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>How to get and set cursor position in TextBox (JSASPNETDiposeTextboxCursor)</h1>
<h2>Introduction</h2>
<p class="MsoNormal">The project illustrates how to get and set cursor position in TextBox and Textarea. This sample can executed in IE,FireFox,Chrome,etc browsers.</p>
<h2>Running the Sample</h2>
<p class="MsoNormal">Please follow these demonstration steps below.</p>
<p class="MsoNormal">Step 1. <span style="">&nbsp;</span>Open the JSASPNETDiposeTextboxCursor.sln. Expand the JSASPNETDiposeTextboxCursor web application, open MainPage.aspx page and press Ctrl &#43; F5 to show it.</p>
<p class="MsoNormal">Step 2. We will see two links on the page. You can click one of them jump to Text.aspx page or Textarea.aspx page.</p>
<p class="MsoNormal">Step 3. Click the target text and get the position in the Textbox below, and you can input an effective value in Set Cursor Position Textbox and click button to set cursor of text.</p>
<p class="MsoNormal">Step 4. When you click the content of textarea to get the cursor position. In IE browser,you can get the coordinates of cursor position, but in FireFox and Chrome, you can get preceding string of cursor in one Textbox,and get rear string
 of cursor in another.you can also write a value to set cursor in textarea like step 3.</p>
<p class="MsoNormal"><span style="">&nbsp;</span>[Note]</p>
<p class="MsoNormal">In Textarea.aspx page, when you begin to get the position of cursor, it will return the forepart of the string in X: TextBox and back part of the string in Y: TextBox. Because most of people like to press enter key to change a new line,
 if you use textarea.value to retrieve the text. You will find enter key is &quot;\r\n&quot; in textarea's text, though the textarea.value cannot know which column the user will press enter key to change lines, so it may trigger some problems of get X and Y
 values. There we separate string by cursor and store them in TextBox controls.</p>
<p class="MsoNormal">[/Note]</p>
<p class="MsoNormal">Step 5. After finish above steps, execute the application with Firefox and Chrome browser.</p>
<p class="MsoNormal">Step 6. Validation finished.</p>
<h2>Using the Code</h2>
<p class="MsoNormal">Step 1. Create a C# &quot;ASP.NET Empty Web Application&quot; in Visual Studio 2010 or Visual Web Developer 2010. Name it as &quot;JSASPNETDiposeTextboxCursor &quot;.</p>
<p class="MsoNormal">Step 2. Create three web form files and name them as &quot;MainPage.aspx&quot;,&quot;Text.aspx&quot;, &quot;Textarea.aspx&quot;.</p>
<p class="MsoNormal">Step 3. Open the MainPage.aspx file,add two links in the page and specify them to another two web forms.
</p>
<p class="MsoNormal">Step 4. Open the text.aspx file, add a table, three textboxes, a button and some labels in page.Write the javascript according to the description in sample file withthe same file name.Then you need to add some events in textbox and buttons.</p>
<h3>The following code is used to show how to create events in TextBox and Button controls</h3>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>HTML</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">html</span>
<pre class="hidden">
&lt;input type=&quot;Text&quot; id=&quot;TextBox1&quot; value=&quot;aaaa     &quot; name=&quot;TextBox1&quot; 
  cols=&quot;50&quot; rows=&quot;10&quot; onmouseup=&quot;GetCursorPosition(this)&quot; onmousedown=
 &quot;GetCursorPosition(this)&quot; onkeyup=&quot;GetCursorPosition(this)&quot; 
  onkeydown=&quot;GetCursorPosition(this)&quot; onfocus=&quot;GetCursorPosition(this)&quot;&lt;/input&gt;


&lt;input type=&quot;button&quot; value=&quot;set cursor position&quot; onclick=&quot;JudgeInputAndSetPosition()&quot;&gt;
&lt;/input&gt;

</pre>
<pre id="codePreview" class="html">
&lt;input type=&quot;Text&quot; id=&quot;TextBox1&quot; value=&quot;aaaa     &quot; name=&quot;TextBox1&quot; 
  cols=&quot;50&quot; rows=&quot;10&quot; onmouseup=&quot;GetCursorPosition(this)&quot; onmousedown=
 &quot;GetCursorPosition(this)&quot; onkeyup=&quot;GetCursorPosition(this)&quot; 
  onkeydown=&quot;GetCursorPosition(this)&quot; onfocus=&quot;GetCursorPosition(this)&quot;&lt;/input&gt;


&lt;input type=&quot;button&quot; value=&quot;set cursor position&quot; onclick=&quot;JudgeInputAndSetPosition()&quot;&gt;
&lt;/input&gt;

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal"></p>
<p class="MsoNormal">Step 5. Open the Textarea.aspx file, add a textarea,three textbox, a button and some labels in page, write the JavaScript according to the sample files. And the event in tag &lt;body&gt;, textarea, button.</p>
<h3>The following code is used to show how to add event handlers </h3>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>HTML</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">html</span>
<pre class="hidden">
&lt;body onload=&quot;LoadPostion(document.forms[0].TextBox1)&quot;&gt;


&lt;textarea id=&quot;TextBox1&quot; name=&quot;TextBox1&quot; cols=&quot;50&quot; rows=&quot;10&quot; 
onmouseup=&quot;GetCursorPosition()&quot;  onmousedown=&quot;GetCursorPosition()&quot;
onkeyup=&quot;GetCursorPosition()&quot;  onkeydown=&quot;GetCursorPosition()&quot; 
onfocus=&quot;GetCursorPosition()&quot;&gt;.... &lt;/textarea&gt;


&lt;input type=&quot;button&quot; value=&quot;set cursor position&quot; onclick=&quot;JudgeInputAndSetPosition()&quot;&gt;
&lt;/input&gt;

</pre>
<pre id="codePreview" class="html">
&lt;body onload=&quot;LoadPostion(document.forms[0].TextBox1)&quot;&gt;


&lt;textarea id=&quot;TextBox1&quot; name=&quot;TextBox1&quot; cols=&quot;50&quot; rows=&quot;10&quot; 
onmouseup=&quot;GetCursorPosition()&quot;  onmousedown=&quot;GetCursorPosition()&quot;
onkeyup=&quot;GetCursorPosition()&quot;  onkeydown=&quot;GetCursorPosition()&quot; 
onfocus=&quot;GetCursorPosition()&quot;&gt;.... &lt;/textarea&gt;


&lt;input type=&quot;button&quot; value=&quot;set cursor position&quot; onclick=&quot;JudgeInputAndSetPosition()&quot;&gt;
&lt;/input&gt;

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></p>
<p class="MsoNormal"><span class="GramE">Step 6.</span> Build the application and you can debug it.</p>
<p class="MsoNormal"></p>
<h2>More Information</h2>
<p class="MsoNormal"><a href="http://msdn.microsoft.com/en-us/library/ms536419(VS.85).aspx">MSDN:
<span class="SpellE">createRange</span> in <span class="SpellE">javascript</span></a></p>
<p class="MsoNormal"><a href="http://msdn.microsoft.com/en-us/library/ms535904(VS.85).aspx">MSDN: object
<span class="SpellE">textarea</span></a></p>
<p class="MsoNormal"><a href="http://geekswithblogs.net/svanvliet/archive/2005/03/24/textarea-cursor-position-with-javascript.aspx"><span class="SpellE">MSDN<span class="GramE">:how</span></span> to set cursor in
<span class="SpellE">textarea</span></a></p>
<p class="MsoNormal"></p>
<p class="MsoNormal"></p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img alt="" src="description/6b4cf5bf-9f01-459f-b9ba-42bff79b68c6image.png">
</a></div>

</div>


    </div>
</body>
</html>
