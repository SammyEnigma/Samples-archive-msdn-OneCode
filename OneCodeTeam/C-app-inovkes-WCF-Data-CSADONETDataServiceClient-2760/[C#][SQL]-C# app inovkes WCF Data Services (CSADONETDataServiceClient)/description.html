<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,1:ImageSprite;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Content/Css:1&amp;amp;hashKey=E7560C71640616C5057FAEACB58DCB00" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/2f95808e-ca34-4249-88ff-44fabe33cdc0Combined.css,1:LinkList,2:ImageSprite,2:SiteFeedbackLink;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Epx/Content/Css:2&amp;amp;hashKey=EEE39C2D6B93379FDAF50337BE99AF8C" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>C# app inovkes WCF Data Services (CSADONETDataServiceClient)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>C# app inovkes WCF Data Services (CSADONETDataServiceClient)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            ADO.NET, WCF Data Services
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Data Access
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary Language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Last Updated</label>
                    <div id="LastUpdated">5/5/2011</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/CSADONETDataServiceClient-aaeafce9">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy Code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p style="font-family:Courier New"></p>
<h2>CONSOLE APPLICATION : CSADONETDataServiceClient Project Overview</h2>
<p style="font-family:Courier New"></p>
<h3>Summary:</h3>
<p style="font-family:Courier New"><br>
CSADONETDataServiceClient example demonstrates an ADO.NET Data Service client<br>
application. It calls certain ADO.NET Data Services for ADO.NET Entity Data <br>
Model, Linq To SQL Data Classes, and non-relational in-memory data, and it <br>
demonstrates these ways (LINQ, ADO.NET query options, custom service <br>
operations) to update and query the data source. <br>
<br>
Please note: The ADO.NET Data Services URLs need to be modified based on your<br>
system's IIS setting. &nbsp;<br>
<br>
</p>
<h3>Project Relation:</h3>
<p style="font-family:Courier New"><br>
CSADONETDataServiceClient -&gt; CSADONETDataService<br>
CSADONETDataServiceClient accesses the ADO.NET Data Services created by <br>
CSADONETDataService.<br>
<br>
</p>
<h3>Demo:</h3>
<p style="font-family:Courier New"><br>
The following steps walk through a demonstration of the ADO.NET Data Services<br>
client sample that calls certain ADO.NET Data Services for ADO.NET Entity <br>
Data Model, Linq To SQL Data Classes, and non-relational in-memory data. &nbsp;<br>
<br>
Step 1: Open the DB project SQLServer2005DB, right click the project file and<br>
select Deploy to create the SQLServer2005DB database in your database <br>
instance.<br>
<br>
Step 2: Modify the connection string information to consistent with your <br>
database instance and account. &nbsp;<br>
<br>
&nbsp;&lt;add name=&quot;SQLServer2005DBConnectionString&quot; connectionString=...<br>
&nbsp;&lt;add name=&quot;SQLServer2005DBEntities&quot; connectionString=...<br>
<br>
Step 3: Build the project CSADONETDataService and CSADONETDataServiceClient.<br>
<br>
Step 4: Run the output executable file of project CSADONETDataServiceClient, <br>
CSADONETDataServiceClient.exe.<br>
<br>
</p>
<h3>Creation Steps:</h3>
<p style="font-family:Courier New"><br>
A. Creating an ordinary Visual C# Console Application and adding the <br>
&nbsp; ADO.NET Data Services references.<br>
<br>
&nbsp; 1. In the same solution of the ADO.NET Data Services project, add a new <br>
&nbsp; &nbsp; &nbsp;Visual C# / Windows / Console Application project named <br>
&nbsp; &nbsp; &nbsp;CSADONETDataServiceClient.<br>
<br>
&nbsp; 2. Right click the References in the Solution Explorer, select <br>
&nbsp; &nbsp; &nbsp;Add Service References….<br>
<br>
&nbsp; 3. In the Add Service Reference dialog, click Discover, add the three <br>
&nbsp; &nbsp; &nbsp;ADO.NET Data Services Samples.svc, SchoolLinqToEntities.svc, and
<br>
&nbsp; &nbsp; &nbsp;SchoolLinqToSQL.svc, rename the Namespace of the services to <br>
&nbsp; &nbsp; &nbsp;SamplesService, SchoolLinqToEntities, and SchoolLinqToSQLService
<br>
&nbsp; &nbsp; &nbsp;respectively.<br>
<br>
B. Creating static ADO.NET Data Services URL fields, local entity classes, <br>
&nbsp; and helper methods.<br>
<br>
&nbsp; 1. Define static fields for the ADO.NET Data Services URL. &nbsp;You need to
<br>
&nbsp; &nbsp; &nbsp;modify the URL to specify the port settings of the localhost. &nbsp;<br>
<br>
&nbsp; 2. Create a local entity class named TempCourse which only have CourseID <br>
&nbsp; &nbsp; &nbsp;and Title properties and misses other properties than the Course entity
<br>
&nbsp; &nbsp; &nbsp;class in the ADO.NET Data Service references.<br>
<br>
&nbsp; 3. Create a local entity class named InnerDataServiceException to hold <br>
&nbsp; &nbsp; &nbsp;the inner exception information of the DataServiceException.<br>
<br>
&nbsp; 4. Create a helper method ParseDataServiceClientException to parse the <br>
&nbsp; &nbsp; &nbsp;DataServiceClientException via LINQ to XML methods, and return a local
<br>
&nbsp; &nbsp; &nbsp;entity class object InnerDataServiceException holding the inner
<br>
&nbsp; &nbsp; &nbsp;exception information.<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>
&nbsp; 5. Create a helper method UpdateData to save the pending modifications of <br>
&nbsp; &nbsp; &nbsp;the DataServiceContext. &nbsp;If all the DataServiceResponse.StatusCode
<br>
&nbsp; &nbsp; &nbsp;start with 2, since the status code 2** means success. &nbsp; For detail,
<br>
&nbsp; &nbsp; &nbsp;please see List of HTTP status codes. &nbsp;If there are any exception occurs
<br>
&nbsp; &nbsp; &nbsp;and the InnerException is in type of DataServiceClientException, use
<br>
&nbsp; &nbsp; &nbsp;the helper method ParseDataServiceClientException to parse the
<br>
&nbsp; &nbsp; &nbsp;exception information.<br>
<br>
C. Updating and querying database via calling ADO.NET Data Service for the <br>
&nbsp; ADO.NET Entity Data Model.<br>
<br>
&nbsp; 1. Initialize the DataService object for the ADO.NET Entity Data Model.<br>
<br>
&nbsp; 2. Create an invalid entity class, add it into the DataService context, <br>
&nbsp; &nbsp; &nbsp;and then try to save the pending modification. &nbsp; Through the helper
<br>
&nbsp; &nbsp; &nbsp;methods UpdateData and ParseDataServiceClientException, we will see
<br>
&nbsp; &nbsp; &nbsp;the exception information from the server side: The valid value of
<br>
&nbsp; &nbsp; &nbsp;PersonCategory is 1 (for students) or 2 (for instructors).<br>
&nbsp; <br>
&nbsp; 3. Create some valid entity classes and some relationships among them, <br>
&nbsp; &nbsp; &nbsp;then save the pending modification. &nbsp;Call AddTo** to add entity
<br>
&nbsp; &nbsp; &nbsp;class and call AddLink to add the relationships. &nbsp;<br>
&nbsp; &nbsp; <br>
&nbsp; 4. Perform a LINQ query which contains where, orderby, Skip, and Take <br>
&nbsp; &nbsp; &nbsp;operators or methods. &nbsp;These four LINQ operators or methods have
<br>
&nbsp; &nbsp; &nbsp;their corresponding supported ADO.NET Data Service query options
<br>
&nbsp; &nbsp; &nbsp;(filter, orderby, skip, top). &nbsp; How to use the query options will
<br>
&nbsp; &nbsp; &nbsp;be introduced in the following steps. &nbsp;<br>
&nbsp; &nbsp; <br>
&nbsp; 5. Call the service operation CourseByPerson to get the certain person’s <br>
&nbsp; &nbsp; &nbsp;courses based on the person table primary key PersonID. &nbsp;The URL for
<br>
&nbsp; &nbsp; &nbsp;the service operation CourseByPersonID can be: <br>
<br>
D. Updating and querying database via ADO.NET Data Service for LINQ to SQL <br>
&nbsp; Classes.<br>
<br>
&nbsp; 1. Initialize the DataService object for the LINQ to SQL Classes.<br>
&nbsp; &nbsp; <br>
&nbsp; 2. Create some valid entity classes and some relationship entity classes, <br>
&nbsp; &nbsp; &nbsp;then save the pending modification. &nbsp;Since LINQ to SQL does not
<br>
&nbsp; &nbsp; &nbsp;implement the many-to-many relationships, we need to add the <br>
&nbsp; &nbsp; &nbsp;relationship entity as well instead of calling AddLink to create the
<br>
&nbsp; &nbsp; &nbsp;relationships. &nbsp;First we add the entity classes, after saving the
<br>
&nbsp; &nbsp; &nbsp;entity classes, then we add the relationship entity class and save the
<br>
&nbsp; &nbsp; &nbsp;data.<br>
&nbsp; &nbsp; &nbsp;<br>
&nbsp; 3. Query the many-to-many relationships through the relationship entity. &nbsp;<br>
&nbsp; &nbsp; &nbsp;First we get all CourseGrade entities of one Person based on the
<br>
&nbsp; &nbsp; &nbsp;PersonID. &nbsp;The URL can be:<br>
&nbsp; &nbsp; &nbsp;<a  href="http://localhost/SchoolLinqToSQL.svc/Persons(PersonID)/CourseGrades.">http://localhost/SchoolLinqToSQL.svc/Persons(PersonID)/CourseGrades.</a><br>
&nbsp; &nbsp; &nbsp;By CourseGrade entity, we can get the Course object via it CourseID. &nbsp;<br>
&nbsp; &nbsp; &nbsp;The URL can be:<br>
&nbsp; &nbsp; &nbsp;<a  href="http://localhost/SchoolLinqToSQL.svc/Courses(CourseID).">http://localhost/SchoolLinqToSQL.svc/Courses(CourseID).</a><br>
&nbsp; &nbsp; &nbsp;<br>
E. Querying the database via ADO.NET query options and custom service <br>
&nbsp; operations.<br>
<br>
&nbsp; 1. Initialize the DataService object. &nbsp;Here we use the ADO.NET Data <br>
&nbsp; &nbsp; &nbsp;Service for ADO.NET Entity Data Model for testing.<br>
&nbsp; &nbsp; &nbsp;<br>
&nbsp; 2. Perform the data source using query options (filter, orderby, skip, <br>
&nbsp; &nbsp; &nbsp;top) directly. &nbsp;The query URL can be:<br>
&nbsp; &nbsp; &nbsp;<a  href="http://localhost/SchoolLinqToEntities.svc/Person?$">http://localhost/SchoolLinqToEntities.svc/Person?$</a><br>
&nbsp; &nbsp; &nbsp;filter=PersonCategory eq 1&$orderby=EnrollmentDate desc&$skip=2&$top=2.<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>
&nbsp; 3. Initialize another DataService object and set the <br>
&nbsp; &nbsp; &nbsp;IgnoreMissingProperties property as true, so that the returned type
<br>
&nbsp; &nbsp; &nbsp;should be mapped to the client side type. &nbsp;Here we use the ADO.NET
<br>
&nbsp; &nbsp; &nbsp;Data Service for LINQ to SQL Classes for testing.<br>
&nbsp; &nbsp; &nbsp;<br>
&nbsp; 4. Call the service operation SearchCourses and use local entity class <br>
&nbsp; &nbsp; &nbsp;LocalCourse to retrieve the returned course information. &nbsp;The query
<br>
&nbsp; &nbsp; &nbsp;URL can be:<br>
&nbsp; &nbsp; &nbsp;<a  href="http://localhost/SchoolLinqToSQL.svc/SearchCourses?searchText=">http://localhost/SchoolLinqToSQL.svc/SearchCourses?searchText=</a><br>
&nbsp; &nbsp; &nbsp;’SELECT * FROM [Course] AS [c] WHERE [c].[Credits] = 4’.<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
F. Updating and querying non-relational data via ADO.NET Data Service for <br>
&nbsp; non-relational data.<br>
<br>
&nbsp; 1. Initialize the DataService object for non-relational data.<br>
&nbsp; &nbsp; &nbsp;<br>
&nbsp; 2. Insert a new entity object into the non-relational data collection.<br>
&nbsp; &nbsp; &nbsp;<br>
&nbsp; 3. Query the non-relational data based on DataServiceKey value and <br>
&nbsp; &nbsp; &nbsp;object links and group the data.<br>
&nbsp; &nbsp; &nbsp;<br>
</p>
<h3>References:</h3>
<p style="font-family:Courier New"><br>
ADO.NET Data Services<br>
<a  href="http://msdn.microsoft.com/en-us/data/bb931106.aspx">http://msdn.microsoft.com/en-us/data/bb931106.aspx</a><br>
<br>
Overview: ADO.NET Data Services<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc956153.aspx">http://msdn.microsoft.com/en-us/library/cc956153.aspx</a><br>
<br>
How Do I: Consume an ADO.NET Data Service in a .NET Application<br>
<a  href="http://msdn.microsoft.com/en-us/data/cc974504.aspx">http://msdn.microsoft.com/en-us/data/cc974504.aspx</a><br>
<br>
Using Microsoft ADO.NET Data Services<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc907912.aspx">http://msdn.microsoft.com/en-us/library/cc907912.aspx</a><br>
<br>
ADO.NET Data Services Team Blog<br>
<a  href="http://blogs.msdn.com/astoriateam/">http://blogs.msdn.com/astoriateam/</a><br>
<br>
MSDN API Reference Documentation – Client<br>
<a  href="http://msdn.microsoft.com/en-us/library/system.data.services.client.aspx">http://msdn.microsoft.com/en-us/library/system.data.services.client.aspx</a><br>
<br>
Query Expressions (ADO.NET Data Services)<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc668784.aspx">http://msdn.microsoft.com/en-us/library/cc668784.aspx</a><br>
<br>
Query Functions (ADO.NET Data Services)<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc668793.aspx">http://msdn.microsoft.com/en-us/library/cc668793.aspx</a><br>
<br>
Filter Query Option: $filter (ADO.NET Data Services Framework)<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc668778.aspx">http://msdn.microsoft.com/en-us/library/cc668778.aspx</a><br>
<br>
Order By Query Option: $orderby (ADO.NET Data Services Framework)<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc668776.aspx">http://msdn.microsoft.com/en-us/library/cc668776.aspx</a><br>
<br>
Top Query Option: $top (ADO.NET Data Services Framework)<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc716654.aspx">http://msdn.microsoft.com/en-us/library/cc716654.aspx</a><br>
<br>
Skip Query Option: $skip (ADO.NET Data Services Framework)<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc668773.aspx">http://msdn.microsoft.com/en-us/library/cc668773.aspx</a><br>
<br>
Addressing Resources (ADO.NET Data Services)<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc668766.aspx">http://msdn.microsoft.com/en-us/library/cc668766.aspx</a><br>
<br>
Service Operations (ADO.NET Data Services)<br>
<a  href="http://msdn.microsoft.com/en-us/library/cc668788.aspx">http://msdn.microsoft.com/en-us/library/cc668788.aspx</a><br>
<br>
Interceptors (ADO.NET Data Services)<br>
<a  href="http://msdn.microsoft.com/en-us/library/dd744842.aspx">http://msdn.microsoft.com/en-us/library/dd744842.aspx</a><br>
<br>
Injecting Custom Logic in ADO.NET Data Services <br>
<a  href="http://weblogs.asp.net/cibrax/archive/2009/06/08/injecting-custom-logic-in-ado-net-data-services.aspx">http://weblogs.asp.net/cibrax/archive/2009/06/08/injecting-custom-logic-in-ado-net-data-services.aspx</a><br>
<br>
List of HTTP status codes<br>
<a  href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http://en.wikipedia.org/wiki/List_of_HTTP_status_codes</a><br>
<br>
<br>
</p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img src="description/3384444c-0fce-4538-886c-126c04fccfb7image.png">
</a></div>

</div>


    </div>
</body>
</html>
