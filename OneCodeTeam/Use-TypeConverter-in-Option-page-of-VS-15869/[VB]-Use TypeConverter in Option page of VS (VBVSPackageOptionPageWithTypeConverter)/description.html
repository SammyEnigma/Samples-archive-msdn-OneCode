<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/1c1e217c-1475-400e-91a7-b2be1bd6efa0Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Use TypeConverter in Option page of VS (VBVSPackageOptionPageWithTypeConverter)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Use TypeConverter in Option page of VS (VBVSPackageOptionPageWithTypeConverter)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            VSX
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            TypeConverter, Option Page
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/1/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/VBVSPackageOptionPageWithTy-6ca62c27">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Use TypeConverter in Option page of VS (<span class="SpellE"><span style="">VB</span>VSPackageOptionPageWithTypeConverter</span>)<span style="">
</span></h1>
<h2>Introduction</h2>
<p class="MsoNormal">This sample demonstrates how to use TypeConverter in Option Page.<span style="">
</span></p>
<p class="MsoNormal">A type converter can be used to convert values between data types, and to<span style="">
</span>assist property configuration at design time by providing text-to-value<span style="">
</span>conversion or a drop-down list of values to select from.<span style=""> </span>
</p>
<h2>Building the Sample</h2>
<p class="MsoNormal">VS 2010 SP1 SDK must be installed on the machine. You can download it from:
</p>
<p class="MsoNormal"><span lang="EN" style=""><a href="http://www.microsoft.com/download/en/details.aspx?id=21835">Visual Studio 2010 SP1 SDK</a></span></p>
<p class="MsoNormal">Set the Start Action and Start Options of Debug.</p>
<p class="MsoNormal">Start Action: <u>C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe</u> (32bit OS) or
<u>C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe</u> (64bit OS)<u>
</u></p>
<p class="MsoNormal">Start Option: <u>/<span class="SpellE">rootsuffix</span>
<span class="SpellE">Exp</span></u></p>
<p class="MsoNormal"><span style=""><img src="description/image.png" alt="" width="576" height="364" align="middle">
</span></p>
<p class="MsoNormal"></p>
<h2>Running the Sample</h2>
<p class="MsoListParagraphCxSpFirst" style=""><span style=""><span style="">1.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>Press <b style="">F5</b> to debug this project.</p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style=""><span style="">2.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span>In the new instance of Visual Studio, click <b style=""><span style="">Tool</span>=&gt;
</b><b style=""><span style="">Options</span></b>, you will see the <span style="">
Options dialog and find <span class="SpellE"><b style="">MyOptionPage</b></span></span>.<span style=""> You can select the value for<b style="">
<span class="SpellE">MyProperty</span>.</b></span></p>
<p class="MsoListParagraphCxSpMiddle"><span style=""><img src="description/608e8b09-07c2-44ab-acb8-65d5e8954cd9image.png" alt="" width="576" height="330" align="middle">
</span></p>
<p class="MsoListParagraphCxSpLast"></p>
<h2>Using the Code</h2>
<p class="MsoListParagraphCxSpFirst" style=""><b style=""><span style=""><span style="">1.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style="">Create a VS Package Project. </b></p>
<p class="MsoListParagraphCxSpMiddle">Use Visual Studio Integration Package Wizard to create a simple VSPackage project. You can follow the steps in
<a href="http://msdn.microsoft.com/en-us/library/cc138589.aspx">Walkthrough: Creating a VSPackage</a></p>
<p class="MsoListParagraphCxSpLast" style=""><b style=""><span style=""><span style="">2.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style="">Add a new class file named <span class="SpellE">
OptionsPage.<span style="">vb</span></span> into the project. </b></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>VB</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">vb</span>
<pre class="hidden">
'/////////////////////////////////////////////////////////////////////////////
' Define an enum type which will be shown in the Option Page.
' 
Public Enum MyEnumProperty
    None
    First
    Second
    Third
End Enum


'/////////////////////////////////////////////////////////////////////////////
' Create a class named OptionsPage which derived from DialogPage class, add
' a MyEnumProperty property in it.
' 
Friend Class OptionsPage
    Inherits DialogPage
#Region &quot;Fields&quot;
    Private _myProperty As MyEnumProperty = MyEnumProperty.None
#End Region ' Fields


#Region &quot;Properties&quot;
    &lt;Category(&quot;Enum Options&quot;), Description(&quot;My enum option&quot;), TypeConverter(GetType(EnumTypeConverter))&gt; _
    Public Property MyProperty() As MyEnumProperty
        Get
            Return _myProperty
        End Get
        Set(ByVal value As MyEnumProperty)
            _myProperty = value
        End Set
    End Property
#End Region ' Properties
End Class

</pre>
<pre id="codePreview" class="vb">
'/////////////////////////////////////////////////////////////////////////////
' Define an enum type which will be shown in the Option Page.
' 
Public Enum MyEnumProperty
    None
    First
    Second
    Third
End Enum


'/////////////////////////////////////////////////////////////////////////////
' Create a class named OptionsPage which derived from DialogPage class, add
' a MyEnumProperty property in it.
' 
Friend Class OptionsPage
    Inherits DialogPage
#Region &quot;Fields&quot;
    Private _myProperty As MyEnumProperty = MyEnumProperty.None
#End Region ' Fields


#Region &quot;Properties&quot;
    &lt;Category(&quot;Enum Options&quot;), Description(&quot;My enum option&quot;), TypeConverter(GetType(EnumTypeConverter))&gt; _
    Public Property MyProperty() As MyEnumProperty
        Get
            Return _myProperty
        End Get
        Set(ByVal value As MyEnumProperty)
            _myProperty = value
        End Set
    End Property
#End Region ' Properties
End Class

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst"><b style=""></b></p>
<p class="MsoListParagraphCxSpLast" style=""><b style=""><span style=""><span style="">3.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style=""><span style="">Define the <span class="SpellE">
EnumTypeConverter</span> class.</span> </b></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>VB</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">vb</span>
<pre class="hidden">
Friend Class EnumTypeConverter
    Inherits EnumConverter
    Public Sub New()
        MyBase.New(GetType(MyEnumProperty))
    End Sub


    Public Overrides Function CanConvertFrom(ByVal context As ITypeDescriptorContext, ByVal sourceType As Type) As Boolean
        If sourceType Is GetType(String) Then
            Return True
        End If


        Return MyBase.CanConvertFrom(context, sourceType)
    End Function


    Public Overrides Function ConvertFrom(ByVal context As ITypeDescriptorContext, ByVal culture As CultureInfo, ByVal value As Object) As Object
        Dim str As String = TryCast(value, String)


        If str IsNot Nothing Then
            If str = &quot;Beautiful None&quot; Then
                Return MyEnumProperty.None
            End If
            If str = &quot;Beautiful First&quot; Then
                Return MyEnumProperty.First
            End If
            If str = &quot;Beautiful Second&quot; Then
                Return MyEnumProperty.Second
            End If
            If str = &quot;Beautiful Third&quot; Then
                Return MyEnumProperty.Third
            End If
        End If


        Return MyBase.ConvertFrom(context, culture, value)
    End Function


    Public Overrides Function ConvertTo(ByVal context As ITypeDescriptorContext, ByVal culture As CultureInfo, ByVal value As Object, ByVal destinationType As Type) As Object
        If destinationType Is GetType(String) Then
            Dim result As String = Nothing
            If CInt(Fix(value)) = 0 Then
                result = &quot;Beautiful None&quot;
            ElseIf CInt(Fix(value)) = 1 Then
                result = &quot;Beautiful First&quot;
            ElseIf CInt(Fix(value)) = 2 Then
                result = &quot;Beautiful Second&quot;
            ElseIf CInt(Fix(value)) = 3 Then
                result = &quot;Beautiful Third&quot;
            End If


            If result IsNot Nothing Then
                Return result
            End If
        End If


        Return MyBase.ConvertTo(context, culture, value, destinationType)
    End Function
End Class

</pre>
<pre id="codePreview" class="vb">
Friend Class EnumTypeConverter
    Inherits EnumConverter
    Public Sub New()
        MyBase.New(GetType(MyEnumProperty))
    End Sub


    Public Overrides Function CanConvertFrom(ByVal context As ITypeDescriptorContext, ByVal sourceType As Type) As Boolean
        If sourceType Is GetType(String) Then
            Return True
        End If


        Return MyBase.CanConvertFrom(context, sourceType)
    End Function


    Public Overrides Function ConvertFrom(ByVal context As ITypeDescriptorContext, ByVal culture As CultureInfo, ByVal value As Object) As Object
        Dim str As String = TryCast(value, String)


        If str IsNot Nothing Then
            If str = &quot;Beautiful None&quot; Then
                Return MyEnumProperty.None
            End If
            If str = &quot;Beautiful First&quot; Then
                Return MyEnumProperty.First
            End If
            If str = &quot;Beautiful Second&quot; Then
                Return MyEnumProperty.Second
            End If
            If str = &quot;Beautiful Third&quot; Then
                Return MyEnumProperty.Third
            End If
        End If


        Return MyBase.ConvertFrom(context, culture, value)
    End Function


    Public Overrides Function ConvertTo(ByVal context As ITypeDescriptorContext, ByVal culture As CultureInfo, ByVal value As Object, ByVal destinationType As Type) As Object
        If destinationType Is GetType(String) Then
            Dim result As String = Nothing
            If CInt(Fix(value)) = 0 Then
                result = &quot;Beautiful None&quot;
            ElseIf CInt(Fix(value)) = 1 Then
                result = &quot;Beautiful First&quot;
            ElseIf CInt(Fix(value)) = 2 Then
                result = &quot;Beautiful Second&quot;
            ElseIf CInt(Fix(value)) = 3 Then
                result = &quot;Beautiful Third&quot;
            End If


            If result IsNot Nothing Then
                Return result
            End If
        End If


        Return MyBase.ConvertTo(context, culture, value, destinationType)
    End Function
End Class

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst"><b style=""></b></p>
<p class="MsoListParagraphCxSpLast" style=""><b style=""><span style=""><span style="">4.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style="">Open the <span class="SpellE">VSPackage.resx</span> file, add two String resource as below
</b></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>XML</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">xml</span>
<pre class="hidden">
&lt;data name=&quot;113&quot; xml:space=&quot;preserve&quot;&gt;
&lt;value&gt;MyOptionsPage&lt;/value&gt;
&lt;/data&gt;
&lt;data name=&quot;114&quot; xml:space=&quot;preserve&quot;&gt;
&lt;value&gt;OptionsPageWithTypeConverter&lt;/value&gt;
&lt;/data&gt;

</pre>
<pre id="codePreview" class="xml">
&lt;data name=&quot;113&quot; xml:space=&quot;preserve&quot;&gt;
&lt;value&gt;MyOptionsPage&lt;/value&gt;
&lt;/data&gt;
&lt;data name=&quot;114&quot; xml:space=&quot;preserve&quot;&gt;
&lt;value&gt;OptionsPageWithTypeConverter&lt;/value&gt;
&lt;/data&gt;

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraphCxSpFirst"><b style=""></b></p>
<p class="MsoListParagraphCxSpLast" style=""><b style=""><span style=""><span style="">5.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><b style="">Assign <span class="SpellE">ProvideOptionPage</span> attribute to the package class for</b><b style=""><span style="">
</span>registering our Option Page </b></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">csharp</span>
<pre class="hidden">
&lt;ProvideOptionPage(GetType(OptionsPage), &quot;MyOptionsPage&quot;, &quot;OptionsPageWithTypeConverter&quot;, 113, 114, True)&gt; _
Public NotInheritable Class VBVSPackageOptionPageWithTypeConverterPackage
    Inherits Package


End Class

</pre>
<pre id="codePreview" class="csharp">
&lt;ProvideOptionPage(GetType(OptionsPage), &quot;MyOptionsPage&quot;, &quot;OptionsPageWithTypeConverter&quot;, 113, 114, True)&gt; _
Public NotInheritable Class VBVSPackageOptionPageWithTypeConverterPackage
    Inherits Package


End Class

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoListParagraph"><b style=""></b></p>
<h2>More Information</h2>
<p class="MsoNormal"><a href="http://msdn.microsoft.com/en-us/library/bb166195(VS.80).aspx">MSDN: Walkthrough: Creating an Options Page (C#)</a><span style="">
</span></p>
<p class="MsoNormal"><span style=""><a href="http://msdn.microsoft.com/en-us/library/ayybcxe5.aspx">MSDN: How to: Implement a Type Converter</a>
</span></p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img alt="" src="description/f0ce43d4-e8ea-415f-bfdd-f6bb39d3f968image.png">
</a></div>

</div>


    </div>
</body>
</html>
