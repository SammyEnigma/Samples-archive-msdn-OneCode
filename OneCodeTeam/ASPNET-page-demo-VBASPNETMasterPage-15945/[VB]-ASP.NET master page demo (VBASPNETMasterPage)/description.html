<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/1c1e217c-1475-400e-91a7-b2be1bd6efa0Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>ASP.NET master page demo (VBASPNETMasterPage)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>ASP.NET master page demo (VBASPNETMasterPage)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            ASP.NET
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Master Page
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/4/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/VBASPNETMasterPage-83651eeb">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>ASP.NET master page demo (<span class="SpellE">VBASPNETMasterPage</span>)</h1>
<h2>Introduction</h2>
<p class="MsoNormal">The project illustrates how to use Master Page. ASP.NET defines two new specialized types of pages: Master Page and Content Page. A Master page is a page template. Like an ordinary ASP.NET web page, it can contain any combination of HTML.
 In addition, Master Page includes a special control called <span class="SpellE">
ContentPlaceHolder</span> which works as a holder of Content Page. On the other hand, each Content Page references a single Master Page and acquires its content. Both Master Page and Content Page work together can allow developers easier to build websites with
 a standard appearance.</p>
<h2>Running the Sample</h2>
<p class="MsoNormal">Please follow these demonstration steps below.</p>
<p class="MsoNormal">Step 1:&nbsp;Open the VBASPNETMasterPage.sln. Expand the <span class="SpellE">
VBASPNETMasterPage</span> web application and press Ctrl &#43; F5 to show the ContentPage.aspx.
</p>
<p class="MsoNormal">Step 2: We can find a little complex web page in browser, the page includes a master page and a content page, we can input some text in content page��s
<span class="SpellE">TextBox</span> control and it will display in master page, the content page is embedded in master page.
</p>
<p class="MsoNormal"><span style=""><img src="description/image.png" alt="" width="529" height="527" align="middle">
</span></p>
<p class="MsoNormal">Step 3: Click <span class="SpellE">gotoNestedContentPage</span> link, we can see the content page is changed. There is another master page as follows, and this master page includes two content pages, you can change the page by clicking
 the links in left. </p>
<p class="MsoNormal"><span style=""><img src="description/66994c0a-26ec-42b3-aeae-66c8400f1693image.png" alt="" width="529" height="527" align="middle">
</span></p>
<p class="MsoNormal">Step 4: Validation finished.</p>
<h2>Using the Code</h2>
<p class="MsoNormal">Code Logical : </p>
<p class="MsoNormal">Step 1. Create a VB &quot;ASP.NET Empty Web Application&quot; in Visual Studio 2010. Name it as ��VBASPNETMasterPage&quot;.<span style="">&nbsp;
</span>Create three web form pages and two master <span class="GramE">page</span>, the ��Master.master�� page is the main master page, it includes all content pages and child master pages inside, the ��ContentPage.aspx�� page is the content page with some
 server controls, the ��NestedMaster.master��, ��NestedContentPageA.aspx��, ��NestedContentPageB.aspx�� pages are nested in Master.master page.</p>
<p class="MsoNormal"><span class="GramE">Step 2.</span> The Master page includes a
<span class="SpellE">ContentPlaceHolder</span> control for nesting in content page; the two Hyperlinks will redirect you to different content pages with ContentPage.aspx and
<span class="SpellE">NestedMasterPage.master</span>. </p>
<h3>The following code showing the Master.master page HTML markup and use ContentPlaceHolder to embed content page:</h3>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>HTML</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">html</span>
<pre class="hidden">
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body style=&quot;background-color:#F7F6F3&quot;&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    <div>
        <h2>Master Page</h2>
        <p>
            &lt;asp:Label ID=&quot;lbHello&quot; runat=&quot;server&quot;&gt;&lt;/asp:Label&gt;
        </p>
        &lt;asp:HyperLink ID=&quot;linkToContentPage&quot; runat=&quot;server&quot; 
                       NavigateUrl=&quot;~/ContentPage.aspx&quot; 
                       Text=&quot;gotoContentPage&quot;&gt;&lt;/asp:HyperLink&gt;&nbsp;


        &lt;asp:HyperLink ID=&quot;linkToNestedContentPage&quot; runat=&quot;server&quot; 
                       NavigateUrl=&quot;~/NestedContentPageA.aspx&quot;
                       Text=&quot;gotoNestedContentPage&quot;&gt;&lt;/asp:HyperLink&gt;
        <hr>
        &lt;%--Content Page Begin--%&gt;
        &lt;asp:ContentPlaceHolder ID=&quot;MainContentHolder&quot; runat=&quot;server&quot;&gt;
        &lt;/asp:ContentPlaceHolder&gt;
        &lt;%--Content Page End--%&gt;
      
    </div>
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;

</pre>
<pre id="codePreview" class="html">
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body style=&quot;background-color:#F7F6F3&quot;&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    <div>
        <h2>Master Page</h2>
        <p>
            &lt;asp:Label ID=&quot;lbHello&quot; runat=&quot;server&quot;&gt;&lt;/asp:Label&gt;
        </p>
        &lt;asp:HyperLink ID=&quot;linkToContentPage&quot; runat=&quot;server&quot; 
                       NavigateUrl=&quot;~/ContentPage.aspx&quot; 
                       Text=&quot;gotoContentPage&quot;&gt;&lt;/asp:HyperLink&gt;&nbsp;


        &lt;asp:HyperLink ID=&quot;linkToNestedContentPage&quot; runat=&quot;server&quot; 
                       NavigateUrl=&quot;~/NestedContentPageA.aspx&quot;
                       Text=&quot;gotoNestedContentPage&quot;&gt;&lt;/asp:HyperLink&gt;
        <hr>
        &lt;%--Content Page Begin--%&gt;
        &lt;asp:ContentPlaceHolder ID=&quot;MainContentHolder&quot; runat=&quot;server&quot;&gt;
        &lt;/asp:ContentPlaceHolder&gt;
        &lt;%--Content Page End--%&gt;
      
    </div>
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal"></p>
<p class="MsoNormal"><span class="GramE">Step 3.</span> The <span class="SpellE">
NestedMaster</span> page is similar to Master page, you need to change Hyperlink��s
<span class="SpellE">NavigateUrl</span> property and write different message in content pages. The another thing we need to handle is that we have to pass the massage in
<span class="SpellE">ContentPage</span> to Master page, here we use <span class="SpellE">
<span class="GramE">Master.FindControl</span></span><span class="GramE">(</span>&quot;<span class="SpellE">lbHello</span>&quot;) method to find master page��s controls.
</p>
<h3>The following code is used to find master page��s control and assign value to Label control.</h3>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>VB</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span>
</div>
<span class="hidden">vb</span>
<pre class="hidden">
Protected Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
    Dim lbMasterPageHello As Label = TryCast(Master.FindControl(&quot;lbHello&quot;), Label)


    If lbMasterPageHello IsNot Nothing Then
        lbMasterPageHello.Text = &quot;Hello, &quot; & txtName.Text & &quot;!&quot;
    End If
End Sub

</pre>
<pre id="codePreview" class="vb">
Protected Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
    Dim lbMasterPageHello As Label = TryCast(Master.FindControl(&quot;lbHello&quot;), Label)


    If lbMasterPageHello IsNot Nothing Then
        lbMasterPageHello.Text = &quot;Hello, &quot; & txtName.Text & &quot;!&quot;
    End If
End Sub

</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p class="MsoNormal"></p>
<p class="MsoNormal">Step 4. Build the application and you can debug it.</p>
<p class="MsoNormal"></p>
<h2>More Information</h2>
<p class="MsoListParagraphCxSpFirst" style=""><span style="font-family:Symbol"><span style="">��<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><a href="http://msdn.microsoft.com/en-us/library/wtxbf3hh.aspx">ASP.NET Master Pages Overview</a></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style="font-family:Symbol"><span style="">��<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><a href="http://msdn.microsoft.com/en-us/library/x2b3ktt7.aspx">Nested ASP.NET Master Pages</a></p>
<p class="MsoListParagraphCxSpMiddle" style=""><span style="font-family:Symbol"><span style="">��<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style=""><a href="http://msdn.microsoft.com/en-us/library/fft2ye18.aspx">Create Content Pages for an ASP.NET Master Page</a>
</span></p>
<p class="MsoListParagraphCxSpLast" style=""><span style="font-family:Symbol"><span style="">��<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style=""><a href="http://msdn.microsoft.com/en-us/library/xxwa0ff0.aspx">How to: Reference ASP.NET Master Page Content</a>
</span></p>
<p class="MsoNormal"></p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img alt="" src="description/f0ce43d4-e8ea-415f-bfdd-f6bb39d3f968image.png">
</a></div>

</div>


    </div>
</body>
</html>
